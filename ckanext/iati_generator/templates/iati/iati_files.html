{% extends "admin/base.html" %}

{% block primary_content_inner %}
  <h1>{{ _("IATI files") }}</h1>

  {% if iati_files %}
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>{{ _("File type") }}</th>
          <th>{{ _("Resource") }}</th>
          <th>{{ _("Valid") }}</th>
          <th>{{ _("Notes") }}</th>
        </tr>
      </thead>
      <tbody>
        {% for row in iati_files %}
          <tr>
            <td>{{ h.iati_file_type(row.file_type) }}</td>
            <td>
              {# link text = resource name; link goes to the resource page #}
              <a href="{{ h.url_for('resource.read', id=row.dataset_name, resource_id=row.resource_id) }}">
                {{ row.resource_name }}
              </a>
            </td>
            <td class="text-center" style="width: 90px;">
              {% if row.valid %}
                <i class="fa fa-check" aria-label="valid" title="{{ _('Valid') }}"></i>
              {% else %}
                <i class="fa fa-times" aria-label="invalid" title="{{ _('Invalid') }}"></i>
              {% endif %}
            </td>
            <td>{{ row.notes }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>{{ _("No IATI files found.") }}</p>
  {% endif %}
{% endblock %}

{% block content_secondary_nav %}
  {{ super() }}
  <ul class="nav nav-pills">
    <li class="active">
      <a href="{{ h.url_for('iati_generator_admin_files.iati_files_index') }}">{{ _('IATI files') }}</a>
    </li>
  </ul>
{% endblock %}

{% block secondary_content %}
  <section class="module module-narrow module-shallow">
    <h2 class="module-heading"><i class="fa fa-info-circle"></i> {{ _('About IATI') }}</h2>
    <div class="module-content">
      <p>
        {{ _("IATI (International Aid Transparency Initiative) is a global standard for publishing data on development and humanitarian resources.") }}
      </p>
      <p>
        {{ _("This page lists the IATI files configured on resources. It shows whether each file is currently valid, and the date/message of the last validation run.") }}
      </p>
      <p>
        {{ _("OKFN IATI library:") }}
        <a href="https://github.com/okfn/okfn-iati" target="_blank" rel="noopener">
          https://github.com/okfn/okfn-iati
        </a>
      </p>
    </div>
  </section>
{% endblock %}
